import os
from tkinter import *
from tkinter import filedialog
from tkinter import messagebox
import PIL.Image
from PIL import Image, ImageTk
import sqlite3

con = sqlite3.connect("DataBase.db")
cur = con.cursor()

cur.execute("""
    CREATE TABLE IF NOT EXISTS Head_category (
        id_Head_category INTEGER PRIMARY KEY,
        Head_category_name TEXT,
        image_filename TEXT,
        category_type TEXT
        )
""")
con.commit()

cur.execute("""
    CREATE TABLE IF NOT EXISTS sub_category (
    id INTEGER PRIMARY KEY,
    Header_Info_name TEXT,
    Sub_Category_name TEXT,
    image_filename TEXT
    )
""")
con.commit()

cur.execute("""
    CREATE TABLE IF NOT EXISTS category_Infomation (
    id_category_infomation INTEGER PRIMARY KEY,
    Header_info_name TEXT,
    Info_name TEXT,
    Info_Sum_Text TEXT,
    Info_Full_Text TEXT
    )
""")
con.commit()



class AddWindow:
    def __init__(self, root_window):
        self.mainroot = root_window

        self.selected_file = None  # Initialize self.selected_file to None

        self.add_window = Toplevel(self.mainroot)
        self.add_window.title("Add Window")
        self.add_window.geometry("800x400")

        self.add_frame = Frame(self.add_window)
        self.add_frame.pack()

        self.Main_listbox = Listbox(self.add_frame,
                               selectmode=SINGLE,
                               font=("Arial", 15)
                               )
        self.Main_listbox.grid(row=1, column=1)

        self.Sub_listbox = Listbox(self.add_frame,
                                   selectmode=SINGLE,
                                   font=("Arial", 15)
                                   )
        self.Sub_listbox.grid(row=1, column=2)

        self.add_Info_button = Button(self.add_frame,
                                 text="Add Infomation",
                                 font=("Arial", 20),
                                 relief=RAISED,
                                 command=self.add_Info
                                      )
        self.add_Info_button.grid(row=2, column=1)

        self.add_sub_category_button = Button(self.add_frame,
                                              text="Add Sub Category",
                                              font=("Arial", 20),
                                              relief=RAISED,
                                              command=self.add_sub_catgeory
                                              )
        self.add_sub_category_button.grid(row=2, column=2)

        self.populate_listbox()

        self.add_sub_category_frame = Frame(self.add_window)

        self.add_sub_category_label = Label(self.add_sub_category_frame,
                                            text="Enter Values for the sub Cat",
                                            font=("Arial", 20),
                                            relief=RAISED)

        self.head_categoryis_label = Label(self.add_sub_category_frame,
                                           text="",
                                           font=("Arial", 20),
                                           relief=RAISED)

        self.enter_cate_name = Label(self.add_sub_category_frame,
                                     text="Enter a name",
                                     font=("Arial", 20),
                                     relief=RAISED)
        self.entry_cate_name = Entry(self.add_sub_category_frame)

        self.select_file_label = Label(self.add_sub_category_frame,
                                       text="Select a file",
                                       font=("Arial", 20),
                                       relief=RAISED)

        self.select_file_button = Button(self.add_sub_category_frame,
                                         text="Select",#
                                         font=("Arial", 20),
                                         relief=RAISED,
                                         command=self.select_file)

        self.add_sub_category = Button(self.add_sub_category_frame,
                                       text="Add category",
                                       font=("Arial", 20),
                                       relief=RAISED,
                                       command=self.add_sub_catgeory
                                       )

    def populate_listbox(self):
        cur.execute("SELECT Head_category_name FROM Head_category")
        existing_buttons = cur.fetchall()
        print(existing_buttons)
        for button in existing_buttons:
            self.Main_listbox.insert(END, button[0])

    def select_file(self):
        self.add_frame.grab_set()
        file_object = filedialog.askopenfile(filetypes=[("Image Files", "*.jpg *.png")])
        self.selected_file = file_object
        self.add_frame.grab_release()

    def add_sub_catgeory(self):
        Info_Header_Name = self.Main_listbox.get(self.Main_listbox.curselection())
        Sub_Category_name = self.entry_cate_name.get()
        image_file_name = self.selected_file
        self.add_frame.pack_forget()

        self.add_sub_category_frame.pack()
        self.add_sub_category_label.grid(row=0, column=1)

        self.head_categoryis_label.grid(row=1, column=0, pady=10)
        self.head_categoryis_label.config(text=f"Head_category_is: {Info_Header_Name}")

        self.enter_cate_name.grid(row=2, column=0)
        self.entry_cate_name.grid(row=2, column=2)

        self.select_file_label.grid(row=3, column=0)
        self.select_file_button.grid(row=3, column=2)

        self.add_sub_category.grid(row=4, column=1)

        # Initialize selected_file_path to the default image path
        selected_file_path = "C:/Users/Maxim/PycharmProjects/RE BOC Leitfaden/Images/No Image.jpg"

        if self.selected_file is not None:
            selected_file_path = self.selected_file.name

        img = Image.open(selected_file_path)
        photo_resized = img.resize((80, 80), PIL.Image.LANCZOS)
        self.photo_resized = ImageTk.PhotoImage(photo_resized)

        cur.execute("SELECT * FROM sub_category WHERE Header_Info_name=? AND Sub_Category_name=? AND image_filename=?",
                    (Info_Header_Name, Sub_Category_name, selected_file_path)
                    )

        existing_button = cur.fetchone()

        print(existing_button)

        # Check if there is an exact match for all three values

        if existing_button:
            top = Toplevel(self.add_window)
            top.title("Custom Modal Error")

            error_message = "Category all ready exist please check if that is the case"

            label = Label(top,
                          text=error_message,
                          font=("Arial", 15),
                          )
            label.pack()

            ok_button = Button(top,
                               text="OK",
                               font=("Arial", 20),
                               command=top.destroy,
                               )
            ok_button.pack()

            # Make the message box modal
            top.grab_set()

        elif Sub_Category_name is None:
            top = Toplevel(self.add_window)
            top.title("Custom Modal Error")

            error_message = "Please input Values in the Text Boxes"

            label = Label(top,
                          text=error_message,
                          font=("Arial", 15),
                          )
            label.pack()

            ok_button = Button(top,
                               text="OK",
                               font=("Arial", 20),
                               command=top.destroy,
                               )
            ok_button.pack()

            # Make the message box modal
            top.grab_set()


        else:
            cur.execute(
                """INSERT INTO sub_category (Header_Info_name, sub_Category_name, image_filename) VALUES (?, ?, ?)""",
                (Info_Header_Name, Sub_Category_name, selected_file_path)
            )
            con.commit()


    def add_Info(self):
        Info_Header_Name = self.listbox.get(self.listbox.curselection())
        Infomation_name = self.entry_cate_name.get()
        self.add_frame.pack_forget()

        self.add_sub_category_frame.pack()
        self.add_sub_category_label.grid(row=0, column=1)

        self.head_categoryis_label.grid(row=1, column=0, pady=10)
        self.head_categoryis_label.config(text=f"Head_category_is: {Info_Header_Name}")

        self.enter_cate_name.grid(row=2, column=0)
        self.entry_cate_name.grid(row=2, column=2)

        self.add_sub_category.grid(row=4, column=1)




class ChangeWindow:
    def __init__(self, root_window):
        self.mainroot = root_window

        self.change_window = Toplevel(self.mainroot)
        self.change_window.title("Change Window")
        self.change_window.geometry("800x400")

        self.change_frame = Frame(self.change_window)
        self.change_frame.pack()

        self.change_label = Label(self.change_frame,
                                  text="What Category do you want to Change",
                                  font=("Arial", 20, "bold"),
                                  relief=RAISED
                                  )
        self.change_label.grid(row=0, column=1)

        self.listbox = Listbox(self.change_frame,
                               selectmode=SINGLE
                               )
        self.listbox.grid(row=1, column=1)

        self.change_open_button = Button(self.change_frame,
                                         text="Open category",
                                         font=("Arial", 20, "bold"),
                                         relief=RAISED,
                                         command=self.open_change_view
                                         )
        self.change_open_button.grid(row=3, column=1)

        self.input_change_frame = Frame(self.change_window)

        self.input_change_label = Label(self.input_change_frame,
                                        text="Please input new Infomation",
                                        font=("Arial", 20),
                                        relief=RAISED
                                        )

        self.new_button_name = Entry(self.input_change_frame)
        self.new_image_file = Button(self.input_change_frame,
                                     text="select new Image",
                                     font=("Arial", 20),
                                     relief=RAISED,
                                     command=self.select_file
                                     )
        self.new_category_type = Entry(self.input_change_frame)

        self.old_button_name = Label(self.input_change_frame,
                                     text="",
                                     font=("Arial", 20),
                                     relief=RAISED
                                    )
        self.old_image_file = Label(self.input_change_frame,
                                    text="",
                                    font=("Arial", 20),
                                    relief=RAISED
                                    )
        self.old_category_type = Label(self.input_change_frame,
                                       text="",
                                       font=("Arial", 20),
                                       relief=RAISED
                                    )

        self.change_old_info_button = Button(self.input_change_frame,
                                             text="Change",
                                             font=("Arial", 20),
                                             relief=RAISED,
                                             command=self.update_databse
                                             )

        self.populate_listbox()

    def populate_listbox(self):
        cur.execute("SELECT Head_category_name FROM Head_category")
        existing_buttons = cur.fetchall()
        for button in existing_buttons:
            self.listbox.insert(END, button[0])

    def select_file(self):
        self.input_change_frame.grab_set()
        file_object = filedialog.askopenfile(filetypes=[("Image Files", "*.jpg *.png")])
        self.selected_file = file_object
        self.input_change_frame.grab_release()

    def update_databse(self):
        new_button_name = self.new_button_name.get()
        new_image_file = self.selected_file.name if self.selected_file else ""
        new_category_type = self.new_category_type.get().lower()

        if not new_button_name or not new_category_type:
            messagebox.showerror("Error", "Please provide values for the new category")
            return

        selected_button = self.listbox.get(self.listbox.curselection())
        cur.execute("UPDATE Head_category SET Head_category_name=?, image_filename=?, category_type=? WHERE Head_category_name=?",
                    (new_button_name, new_image_file, new_category_type, selected_button))
        con.commit()

        app.display_existing_buttons()

    def open_change_view(self):
        selected_button = self.listbox.get(self.listbox.curselection())

        cur.execute("SELECT Head_category_name, image_filename, category_type FROM Head_category WHERE Head_category_name=?",
                    (selected_button,))

        result = cur.fetchone()

        if result:
            button_name, image_filename, category_type = result

            file_path = image_filename
            file_name = os.path.basename(file_path)

            self.old_button_name.config(text=f"Head_category_name: {button_name}")
            self.old_image_file.config(text=f"Image_filename: {file_name}")
            self.old_category_type.config(text=f"category_type: {category_type}")

        self.change_frame.pack_forget()
        self.input_change_frame.pack()
        self.input_change_label.grid(row=0, column=1)

        self.old_button_name.grid(row=1, column=0, pady=10)
        self.old_image_file.grid(row=2, column=0, pady=10)
        self.old_category_type.grid(row=3, column=0, pady=10)

        self.new_button_name.grid(row=1, column=2, pady=10)
        self.new_image_file.grid(row=2, column=2, pady=10)
        self.new_category_type.grid(row=3, column=2, pady=10)

        self.change_old_info_button.grid(row=4, column=1)


class DeleteWindow:
    def __init__(self, root_window):
        self.mainroot = root_window

        self.delete_window = Toplevel(self.mainroot)
        self.delete_window.title("Delete Window")
        self.delete_window.geometry("800x400")

        self.delete_frame = Frame(self.delete_window)
        self.delete_frame.pack()

        self.delete_label = Label(self.delete_frame,
                                  text="What Category do you want to delete",
                                  font=("Arial", 20, "bold"),
                                  relief=RAISED
                                  )
        self.delete_label.grid(row=0, column=1)

        self.listbox = Listbox(self.delete_frame,
                               selectmode=SINGLE
                               )
        self.listbox.grid(row=1, column=1)

        self.delete_button = Button(self.delete_frame,
                                    text="Delete",
                                    font=("Arial", 15, "bold"),
                                    command=self.delete_head_category
                                    )
        self.delete_button.grid(row=3, column=1)

        self.populate_listbox()

    def populate_listbox(self):
        cur.execute("SELECT Head_category_name, image_filename, category_type FROM Head_category")
        existing_buttons = cur.fetchall()
        for button_data in existing_buttons:
            button_name, _, _ = button_data  # Extract the button name
            self.listbox.insert(END, button_name)

    def delete_head_category(self):
        selected_button = self.listbox.get(self.listbox.curselection())
        result = messagebox.askokcancel("Confirm Deletion", f"Delete button: {selected_button}")
        if result:
            # Delete the database entry
            cur.execute("DELETE FROM Head_category WHERE Head_category_name=?", (selected_button,))
            con.commit()

            # Delete the corresponding module (.py file)
            module_name = selected_button + ".py"
            if os.path.exists(module_name):
                os.remove(module_name)

            # Remove the selected item from the listbox
            self.listbox.delete(self.listbox.curselection())

            app.display_existing_buttons()


# Opens a Window that allows the creation of Category Buttons
class CreatedWindow:
    def __init__(self, root_window, content_frame):
        self.mainroot = root_window
        self.content_frame = content_frame
        self.selected_file = None  # Initialize self.selected_file to None

        self.created_buttons = []
        self.images = {}

        # creates the frame to hold the creation wigets
        self.input_window = Toplevel(self.mainroot,)
        self.input_window.title("Create Window")
        self.input_window.geometry("800x400")

        self.ask_frame = Frame(self.input_window,)
        self.ask_frame.pack(expand=True, fill=BOTH)

        # asks the user what he wants to do
        self.ask_type = Label(self.ask_frame,
                              text="Do you want to Created a Singel or Multi Head Catogory ?",
                              font=("Arial", 20),
                              relief=RAISED,
                              bd=10
                              )
        self.ask_type.grid(row=0, column=0, columnspan=3, pady=10)

        self.modual_name = Label(self.ask_frame,
                                  text="Input a Name",
                                  font=("Arial", 20),
                                 relief=RAISED,
                                 )
        self.modual_name.grid(row=1, column=0)

        self.modual_entry = Entry(self.ask_frame)
        self.modual_entry.grid(row=1, column=2)

        self.modual_image = Label(self.ask_frame,
                                  text="Select a Image",
                                  font=("Arial", 20),
                                  relief=RAISED,
                                  )
        self.modual_image.grid(row=2, column=0)

        self.image_button = Button(self.ask_frame,
                                   text="Select file",
                                   font=("Arial", 20),
                                   command=self.select_file
                                   )
        self.image_button.grid(row=2, column=2)

        self.ask_type = Label(self.ask_frame,
                              text="Singel or Multi ?",
                              font=("Arial", 20),
                              relief=RAISED,
                              )
        self.ask_type.grid(row=3, column=0)

        self.ask_type_entry = Entry(self.ask_frame)
        self.ask_type_entry.grid(row=3, column=2)

        self.created_button = Button(self.ask_frame,
                                     text="Created new Category",
                                     font=("Arial", 20),
                                     command=self.created_category
                                     )
        self.created_button.grid(row=4, column=1)

    # select the image file for the button that leads to the modual that is created
    def select_file(self):
        self.ask_frame.grab_set()
        file_object = filedialog.askopenfile(filetypes=[("Image Files", "*.jpg *.png")])
        self.selected_file = file_object
        self.ask_frame.grab_release()

    # creates the modual with the user input and creates the button for the infomation
    def created_category(self):
        Category_name = self.modual_entry.get()
        Category_type = self.ask_type_entry.get().lower()  # Convert to lowercase for case-insensitive comparison

        # Initialize selected_file_path to the default image path
        selected_file_path = "C:/Users/Maxim/PycharmProjects/RE BOC Leitfaden/Images/No Image.jpg"

        if self.selected_file is not None:
            selected_file_path = self.selected_file.name

        img = Image.open(selected_file_path)
        photo_resized = img.resize((80, 80), PIL.Image.LANCZOS)
        self.photo_resized = ImageTk.PhotoImage(photo_resized)

        cur.execute("SELECT * FROM Head_category WHERE Head_category_name=? AND image_filename=? AND category_type=?",
                    (Category_name, selected_file_path, Category_type)
                    )

        existing_button = cur.fetchone()

        # Check if there is an exact match for all three values

        if existing_button:
            top = Toplevel(self.input_window)
            top.title("Custom Modal Error")

            error_message = "Category all ready exist please check if that is the case"

            label = Label(top,
                          text=error_message,
                          font=("Arial", 15),
                          )
            label.pack()

            ok_button = Button(top,
                               text="OK",
                               font=("Arial", 20),
                               command=top.destroy,
                               )
            ok_button.pack()

            # Make the message box modal
            top.grab_set()


        # if multi
        elif Category_type == "multi":
            with open(f"{Category_name}.py", "w") as file:
                file.write(Category_name)
            button_name = Button(self.content_frame,
                                text=Category_name,
                                font=("Arial", 20),
                                image=self.photo_resized,
                                compound="left"
                                )

            button_name.image = self.photo_resized  # Store the image object
            self.created_buttons.append(button_name)
            self.images[Category_name] = self.photo_resized  # Store the image in the dictionary

            cur.execute(
                """INSERT INTO Head_category (Head_category_name, image_filename, category_type) VALUES (?, ?, ?)""",
                        (Category_name, selected_file_path, Category_type)
            )
            con.commit()

            app.display_existing_buttons()


        elif Category_type == "singel":
            with open(f"{Category_name}.py", "w") as file:
                file.write(Category_name)
            button_name = Button(self.content_frame,
                                 text=Category_name,
                                 font=("Arial", 20),
                                 image=self.photo_resized,
                                 compound="left"
                                 )

            button_name.image = self.photo_resized  # Store the image object
            self.created_buttons.append(button_name)
            self.images[Category_name] = self.photo_resized  # Store the image in the dictionary

            cur.execute(
                """INSERT INTO Head_category (Head_category_name, image_filename, category_type) VALUES (?, ?, ?)""",
                (Category_name, selected_file_path, Category_type)
            )
            con.commit()

            app.display_existing_buttons()


        else:
            top = Toplevel(self.input_window)
            top.title("Custom Modal Error")

            error_message = "Please input a File Type Multi or Singel"

            label = Label(top,
                          text=error_message,
                          font=("Arial", 15),
                          )
            label.pack()

            ok_button = Button(top,
                               text="OK",
                               font=("Arial", 20),
                               command=top.destroy,
                               )
            ok_button.pack()

            # Make the message box modal
            top.grab_set()


# login for the creation, adding, changing or deleting for infomation catogorys
class LoginFrame:
    def __init__(self, root_window, content_frame):
        self.mainroot = root_window
        self.content_frame = content_frame

        self.login_frame = Frame(self.mainroot)
        self.login_frame.pack()

        self.login_button = Button(self.login_frame,
                              text="Login",
                              font=("Arial", 25, "bold", "underline"),
                              relief=RAISED,
                              command=self.password_check

                              )
        self.login_button.grid(row=1, column=1, padx=80, pady=5)

        self.logout_button = Button(self.login_frame,
                               text="Logout",
                               font=("Arial", 25, "bold", "underline"),
                               relief=RAISED,
                               command=self.logout
                               )

        self.admin_entry = Entry(self.login_frame,
                            show="*",
                            bg="#AAAFA8",
                            fg="black",
                            relief=RIDGE
                                        )
        self.admin_entry.grid(row=2, column=1)

        self.created_button = Button(self.login_frame,
                                text="Created",
                                font=("Arial", 20, "bold", "underline"),
                                relief=RAISED,
                                command=self.open_created_window
                                )

        self.change_button = Button(self.login_frame,
                               text="Change",
                               font=("Arial", 20, "bold", "underline"),
                               relief=RAISED,
                               command=self.open_change_window
                               )

        self.delete_button = Button(self.login_frame,
                               text="Delete",
                               font=("Arial", 20, "bold", "underline"),
                               relief=RAISED,
                               width=7,
                               command=self.open_delete_window
                               )

        self.add_button = Button(self.login_frame,
                                 text="Add",
                                 font=("Arial", 20, "bold", "underline"),
                                 relief=RAISED,
                                 width=7,
                                 command=self.open_add_window
                                 )

    def password_check(self):
        admin_password = self.admin_entry.get()
        if admin_password == "1":
            self.created_button.grid(row=1, column=2, sticky=E, padx=15, pady=25)
            self.delete_button.grid(row=2, column=2)
            self.change_button.grid(row=1, column=3, pady=10)
            self.add_button.grid(row=2, column=3)
            self.login_button.grid_forget()
            self.logout_button.grid(row=1, column=1, padx=80, pady=5)

        else:
            pass

    def logout(self):
        self.logout_button.grid_forget()
        self.change_button.grid_forget()
        self.created_button.grid_forget()
        self.delete_button.grid_forget()
        self.add_button.grid_forget()
        self.login_button.grid(row=1, column=1, padx=80, pady=5)

    def open_created_window(self):
        created_window = CreatedWindow(self.mainroot, self.content_frame)

    def open_delete_window(self):
        delete_window = DeleteWindow(self.mainroot)

    def open_change_window(self):
        change_window = ChangeWindow(self.mainroot)

    def open_add_window(self):
        add_window = AddWindow(self.mainroot)


frames = {}

def add_frame(frame_name, frame):
    global frames
    frames[frame_name] = frame

# Zwischen Notiz Funktion so umschreiben das sich der letzte frame/classe gemerkt wird um den dan wirder zu callen
def switch_to_frame(frame_name, sub_content_frame):
    for name, frame in frames.items():
        if name != frame_name:
            frame.pack_forget()
            MainWindow(root_window)
            sub_content_frame.pack_forget()
        else:
            frame.pack(fill=BOTH, expand=True)

# main window for the wiegets and frames
class MainWindow:
    def __init__(self, root_window):
        self.mainroot = root_window
        self.mainroot.title("BOC LEITFADEN")
        self.mainroot.geometry("2560x1600")
        self.mainroot.state("zoomed")

        folder_name = "Images"
        image_file_name = "BOC_Leasing.png"

        # Store information about created buttons
        self.created_buttons_info = {}
        self.created_subcategory_ingo = {}

        script_dir = os.path.dirname(__file__)

        image_path = os.path.join(script_dir, folder_name, image_file_name)

        img = Image.open(image_path)
        photo_resized = img.resize((160, 160), PIL.Image.LANCZOS)
        self.BOC_Main_icon = ImageTk.PhotoImage(photo_resized)

        self.main_frame = Frame(self.mainroot)
        self.main_frame.pack()

        self.main_label = Label(self.main_frame,
                           text="BOC LEITFADEN",
                           font=("Arial", 40, "bold", "underline"),
                           relief=RAISED,
                           image=self.BOC_Main_icon,
                           compound="bottom",
                           bd=10,
                           padx=10,
                           pady=10,
                           )
        self.main_label.pack()

        self.content_frame = Frame(root_window)
        self.content_frame.pack(fill=BOTH, expand=True)

        self.display_existing_buttons()

        top_left = LoginFrame(root_window, self.content_frame)
        top_left.login_frame.place(x=1, height=200, width=620)

    def display_existing_buttons(self):
        for widget in self.content_frame.winfo_children():
            widget.destroy()

        cur.execute("SELECT Head_category_name, image_filename, category_type FROM Head_category")
        existing_buttons = cur.fetchall()

        num_row = 3
        num_column = 4

        r = 0
        c = 0

        for button_data in existing_buttons:
            button_name, image_filename, category_type = button_data

            if category_type == "multi":
                img = Image.open(image_filename)
                photo_resized = img.resize((80, 80), PIL.Image.LANCZOS)
                photo_resized = ImageTk.PhotoImage(photo_resized)
                button = Button(self.content_frame,
                                text=button_name,
                                font=("Arial", 25),
                                image=photo_resized,
                                compound="left",
                                command=lambda category_name=button_name, category_image=photo_resized: self.open_category(category_name, category_image)
                                )
                button.grid(row=r, column=c, padx=50, pady=50)

                # Store information about the created button
                self.created_buttons_info[button_name] = {
                    'image': photo_resized,
                    'button': button,
                    'type' : category_type
                }

                # Increment row and column counters
                c += 1
                if c >= num_column:
                    c = 0
                    r += 1

            if category_type == "singel":
                img = Image.open(image_filename)
                photo_resized = img.resize((80, 80), PIL.Image.LANCZOS)
                photo_resized = ImageTk.PhotoImage(photo_resized)
                button = Button(self.content_frame,
                                text=button_name,
                                font=("Arial", 25),
                                image=photo_resized,
                                compound="left"
                                )
                button.grid(row=r, column=c, padx=50, pady=50)

                # Store information about the created button
                self.created_buttons_info[button_name] = {
                    'image': photo_resized,
                    'button': button,
                    'type': category_type
                }

                # Increment row and column counters
                c += 1
                if c >= num_column:
                    c = 0
                    r += 1

    def open_category(self, category_name, category_image):
        self.main_frame.pack_forget()
        self.content_frame.pack_forget()

        open_sub_category = sub_categorys(self.mainroot, category_name, category_image)

class sub_categorys:
    def __init__(self, root_window, category_name, category_image):

        self.mainroot = root_window
        self.category_frame = Frame(self.mainroot)
        self.category_frame.pack()
        add_frame(category_name, self.category_frame)

        self.created_sub_category = {}

        self.category_label = Label(self.category_frame,
                                    text=category_name,
                                    font=("Arial", 40),
                                    relief=RAISED,
                                    compound="left",
                                    image=category_image)
        self.category_label.pack()

        self.back_button = Button(self.category_frame,
                                  text="Main Menu",
                                  font=("Arial", 30),
                                  relief=RAISED,
                                  command=lambda: switch_to_frame(self.category_frame, self.sub_content_frame),
                                  )
        self.back_button.pack()

        self.sub_content_frame = Frame(self.mainroot)
        self.sub_content_frame.pack(fill=BOTH, expand=True)

        self.display_existing_subcategory(category_name)

    def display_existing_subcategory(self, category_name):
        for widget in self.sub_content_frame.winfo_children():
            widget.destroy()

        Header_Info_name_to_check = category_name

        cur.execute('''
            SELECT *
            FROM sub_category sc
            JOIN Head_category hc ON sc.Header_Info_name = hc.Head_category_name
            WHERE sc.Header_Info_name = ?
            ''', (Header_Info_name_to_check,))

        result = cur.fetchall()

        # Function to check the presence of the desired value in the dataset
        def check_desired_value(dataset, desired_value):
            matched_entries = [entry for entry in dataset if
                               entry[1] == desired_value]  # Assuming the second column is for 'category_name'
            # print(matched_entries)
            for entry in dataset:
                if entry[0] == desired_value:
                    matched_entries.append(entry)
            # print(matched_entries)
            return matched_entries

        result_message = check_desired_value(result, category_name)

        extracted_values = [(entry[1], entry[2], entry[3]) for entry in result_message]

        num_row = 3
        num_column = 5

        r = 0
        c = 0

        for button_data in extracted_values:
            Header_Info_name, Sub_Category_name, image_filename = button_data


            img = Image.open(image_filename)
            photo_resized = img.resize((80, 80), PIL.Image.LANCZOS)
            photo_resized = ImageTk.PhotoImage(photo_resized)
            #print(photo_resized)
            button = Button(self.sub_content_frame,
                            text=Sub_Category_name,
                            font=("Arial", 25),
                            image=photo_resized,
                            compound="left",
                            )
            button.grid(row=r, column=c, padx=50, pady=50)

            # Store information about the created button
            self.created_sub_category[Sub_Category_name] = {
                'Header_Category': Header_Info_name,
                'Sub_Category': Sub_Category_name,
                'Image_filename' : photo_resized
            }

            # Increment row and column counters
            c += 1
            if c >= num_column:
                c = 0
                r += 1

class display_infomation:
    def __init__(self):
        pass





if __name__ == "__main__":
    root_window = Tk()
    app = MainWindow(root_window)
    root_window.mainloop()
